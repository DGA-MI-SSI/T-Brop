# -*- coding: utf-8 -*-


import dumbGadget

data = b""

data+=(b"\x41\x56\x45\x33\xc0\x48\x8b\xf9\x48\x8b\xd7\x57\x48\x8B\x91\x88\x00\x00\x00\x48\x8D\x05\x4F\x41\xF8\xFF\x48\x85\xD2\x48\x0F\x44\xD0\x48\x89\x91\x88\x00\x00\x00\x4C\x8B\xD2\x48\x81\xEA\x80\x01\x00\x00\x48\x89\x52\x18\x4C\x89\x52\x20\x41\x0F\x20\xC0\x4C\x89\x82\xC0\x01\x00\x00\x41\x0F\x20\xD0\x4C\x89\x82\xC8\x01\x00\x00\x41\x0F\x20\xD8\x4C\x89\x82\xD0\x01\x00\x00\x41\x0F\x20\xE0\x4C\x89\x82\xD8\x01\x00\x00\xc3")

data+=(b"\x4d\x85\xff\x0F\x84\xC7\x01\x00\x00\xFF\xE0")

data+=(b"\x41\x56\x45\x33\xc0\x48\xff\x25\xa2\x46\x27\x00")

data+=(b"\x00\x00\x00\x48\x8b\xd3\x48\x8b\xff\x57\x30")
data+=(b"\x20\xB9\x02\x00\x00\x00\x48\x0B\xC2\x48\x8D\x97\x78\x01\x00\x00\x48\x8B\xE8\x41\xFF\x91\xA0\x00\x00\x00")
data+=(b"\x44\x87\x3d\x4c\xdd\x3c\x00\x4c\x87\xc2\xff\xe0")
data+=(b"\x91\x9E\xFF\x4C\x8D\x5C\x24\x60\x49\x8B\x5B\x38\x49\x8B\x6B\x40\x49\x8B\x73\x48\x49\x8B\xE3\x41\x5F\x41\x5E\x41\x5D\x41\x5C\x5F\xC3")

data+=(b"\x48\x81\xc4\x40\x01\x00\x00\xff\xe0")
data+=(b"\x8b\x5c\x24\x30\x48\x83\xc4\x20\x5f\xc3")
data+=(b"\x48\x81\xc4\xE0\xFF\xFF\xFF\xc2\x18\x00")
data+=(b"\x01\xe8\xa4\xc3")
data+=(b"\x41\x56\x45\x33\xc0\x48\x8b\xf9\x48\x8b\xd7\x57\x48\x8B\x91\x88\x00\x00\x00\x48\x8D\x05\x4F\x41\xF8\xFF\x48\x85\xD2\x48\x0F\x44\xD0\x48\x89\x91\x88\x00\x00\x00\x4C\x8B\xD2\x48\x81\xEA\x80\x01\x00\x00\x48\x89\x52\x18\x4C\x89\x52\x20\x41\x0F\x20\xC0\x4C\x89\x82\xC0\x01\x00\x00\x41\x0F\x20\xD0\x4C\x89\x82\xC8\x01\x00\x00\x41\x0F\x20\xD8\x4C\x89\x82\xD0\x01\x00\x00\x41\x0F\x20\xE0\x4C\x89\x82\xD8\x01\x00\x00\xc3")

data+=(b"\x4d\x85\xff\x0F\x84\xC7\x01\x00\x00\xFF\xE0")

data+=(b"\x41\x56\x45\x33\xc0\x48\xff\x25\xa2\x46\x27\x00")

data+=(b"\x00\x00\x00\x48\x8b\xd3\x48\x8b\xff\x57\x30")
data+=(b"\x20\xB9\x02\x00\x00\x00\x48\x0B\xC2\x48\x8D\x97\x78\x01\x00\x00\x48\x8B\xE8\x41\xFF\x91\xA0\x00\x00\x00")
data+=(b"\x44\x87\x3d\x4c\xdd\x3c\x00\x4c\x87\xc2\xff\xe0")
data+=(b"\x91\x9E\xFF\x4C\x8D\x5C\x24\x60\x49\x8B\x5B\x38\x49\x8B\x6B\x40\x49\x8B\x73\x48\x49\x8B\xE3\x41\x5F\x41\x5E\x41\x5D\x41\x5C\x5F\xC3")
data+=(b"\x92\xC2\xE8\xb8")
data+=(b"\x40\x48\x8B\x74\x24\x48\x48\x83\xC4\x30\x5F\xC3")
data+=(b"\x48\x89\x74\x24\x48\x48\x83\xC4\x30\x5F\xC3")
data+=(b"\x48\x8b\xe0\x48\x89\x74\x24\x48\x48\x83\xC4\x30\x5F\xC3")
data+=(b"\x48\x89\x74\x24\x48\xff\xe0")
data+=(b"\x48\x89\x74\x24\x48\x48\x83\xC4\x48\x5f\xff\xe0")
data+=(b"\x58\xc3")
data+=(b"\x03\x48\x89\x58\x08\x0F\xB6\x45\x01\x41\x3B\xC2\x0F\x85")
data+=(b"\x00\x00\x00\xE9\x9B\xE4\xFF\xFF\x49\x8B\xC2\xE9\xB6")
data+=(b"\x48\x8B\xCB\x4C\x8B\x05\x23\x02\x1F\x00\x41\xFF\xD0")
data+=(b"\x5e\x5b\xC3")
data+=(b"\x01\xe8\xa4\xC3")
data+=(b"\x8D\x97\x78\x01\x00\x00\x48\x8B\xE8\x41\xFF\x91\xA0\x00\x00\x00")

data=b"\x48\x03\x1c\x8a\x48\xf7\xeb\xff\x90\xfe\xfe\x05\x0c"

data=b"\x50\x53\x51\x48\x89\xd9\x48\x89\xc3\x58\x5a\x5e\x5f\xc2\x10\x00"

data=b"\x48\xff\xc9\x48\xad\xc3"

data=b"\x48\x89\xe3\x48\x89\x0b\x58\xc3"

gdgtCollection = dumbGadget.dumbGadget('x64',data)


gdgtCollection.dumbGadgets(max_cost=132)

for gdgt in gdgtCollection.gdgtCollection:
    print(hex(gdgt.firstInst.address),":")
    
    for inst in gdgt.instList:
        print(inst.bytes.hex().rjust(16), "\t", inst.mnemonic, inst.op_str)
 
    print("")
    
    print("Cost:", gdgt.cost())
    
    
    print(gdgt.gadgetMatrix.printDep())
    
    print("")

    
    print("\n----------------------------------------------")


print(len(gdgtCollection.gdgtCollection))









